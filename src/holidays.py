from functools import lru_cache

from src import tools

EXCHANGE_HOLIDAYS = {
    'NYSE': {
        '2018-01-01 00:00:00+0000',
        '2018-01-15 00:00:00+0000',
        '2018-02-19 00:00:00+0000',
        '2018-03-30 00:00:00+0000',
        '2018-05-28 00:00:00+0000',
        '2018-07-04 00:00:00+0000',
        '2018-09-03 00:00:00+0000',
        '2018-11-22 00:00:00+0000',
        "2018-12-05 00:00:00+0000",
        '2018-12-25 00:00:00+0000',

        '2019-01-01 00:00:00+0000',
        '2019-01-21 00:00:00+0000',
        '2019-02-18 00:00:00+0000',
        '2019-04-19 00:00:00+0000',
        '2019-05-27 00:00:00+0000',
        '2019-07-04 00:00:00+0000',
        '2019-09-02 00:00:00+0000',
        '2019-11-28 00:00:00+0000',
        '2019-12-25 00:00:00+0000',

        '2020-01-01 00:00:00+0000',
        '2020-01-20 00:00:00+0000',
        '2020-02-17 00:00:00+0000',
        '2020-04-10 00:00:00+0000',
        '2020-05-25 00:00:00+0000',
        '2020-07-03 00:00:00+0000',
        '2020-09-07 00:00:00+0000',
        '2020-11-26 00:00:00+0000',
        '2020-12-25 00:00:00+0000',

        '2021-01-01 00:00:00+0000',
        '2021-01-18 00:00:00+0000',
        '2021-02-15 00:00:00+0000',
        '2021-04-02 00:00:00+0000',
        '2021-05-31 00:00:00+0000',
        '2021-07-05 00:00:00+0000',
        '2021-09-06 00:00:00+0000',
        '2021-11-25 00:00:00+0000',
        '2021-12-24 00:00:00+0000',

        '2022-01-01 00:00:00+0000',
        '2022-01-17 00:00:00+0000',
        '2022-02-21 00:00:00+0000',
        '2022-04-15 00:00:00+0000',
        '2022-05-30 00:00:00+0000',
        '2022-07-04 00:00:00+0000',
        '2022-09-05 00:00:00+0000',
        '2022-11-24 00:00:00+0000',
        '2022-12-26 00:00:00+0000'
    },
    'NASDAQ': {
        '2018-01-01 00:00:00+0000',
        '2018-01-15 00:00:00+0000',
        '2018-02-19 00:00:00+0000',
        '2018-03-30 00:00:00+0000',
        '2018-05-28 00:00:00+0000',
        '2018-07-04 00:00:00+0000',
        '2018-09-03 00:00:00+0000',
        '2018-11-22 00:00:00+0000',
        "2018-12-05 00:00:00+0000",
        '2018-12-25 00:00:00+0000',

        '2019-01-01 00:00:00+0000',
        '2019-01-21 00:00:00+0000',
        '2019-02-18 00:00:00+0000',
        '2019-04-19 00:00:00+0000',
        '2019-05-27 00:00:00+0000',
        '2019-07-04 00:00:00+0000',
        '2019-09-02 00:00:00+0000',
        '2019-11-28 00:00:00+0000',
        '2019-12-25 00:00:00+0000',

        '2020-01-01 00:00:00+0000',
        '2020-01-20 00:00:00+0000',
        '2020-02-17 00:00:00+0000',
        '2020-04-10 00:00:00+0000',
        '2020-05-25 00:00:00+0000',
        '2020-07-03 00:00:00+0000',
        '2020-09-07 00:00:00+0000',
        '2020-11-26 00:00:00+0000',
        '2020-12-25 00:00:00+0000',

        '2021-01-01 00:00:00+0000',
        '2021-01-18 00:00:00+0000',
        '2021-02-15 00:00:00+0000',
        '2021-04-02 00:00:00+0000',
        '2021-05-31 00:00:00+0000',
        '2021-07-05 00:00:00+0000',
        '2021-09-06 00:00:00+0000',
        '2021-11-25 00:00:00+0000',
        '2021-12-24 00:00:00+0000',

        '2022-01-01 00:00:00+0000',
        '2022-01-17 00:00:00+0000',
        '2022-02-21 00:00:00+0000',
        '2022-04-15 00:00:00+0000',
        '2022-05-30 00:00:00+0000',
        '2022-07-04 00:00:00+0000',
        '2022-09-05 00:00:00+0000',
        '2022-11-24 00:00:00+0000',
        '2022-12-26 00:00:00+0000'
    }
}


@lru_cache(maxsize=16)
def dates(exchange: str):
    return {tools.dt_parse(d) for d in EXCHANGE_HOLIDAYS[exchange]}
